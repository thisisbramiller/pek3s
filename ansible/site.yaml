- name: install k3s
  hosts: kube_cluster
  gather_facts: true
  roles:
    - role: prerequisites
      become: true
    - role: download
      become: true

- name: Setup k3s control plane
  hosts: control_plane
  roles:
    - role: k3s_control_plane
      become: true

- name: Setup k3s agents
  hosts: worker_nodes
  roles:
    - role: k3s_worker_nodes
      become: true

- name: Configure k3s cluster
  hosts: control_plane
  roles:
    - role: k3s_control_plane_post
      become: true